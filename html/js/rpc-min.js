var gadgets=gadgets||{};gadgets.util=function(){function F(){var K;var J=document.location.href;var H=J.indexOf("?");var I=J.indexOf("#");if(I===-1){K=J.substr(H+1)}else{K=[J.substr(H+1,I-H-1),"&",J.substr(I+1)].join("")}return K.split("&")}var D=null;var C={};var E=[];var A={0:false,10:true,13:true,34:true,39:true,60:true,62:true,92:true,8232:true,8233:true};function B(H,I){return String.fromCharCode(I)}function G(H){C=H["core.util"]||{}}if(gadgets.config){gadgets.config.register("core.util",null,G)}return{getUrlParameters:function(){if(D!==null){return D}D={};var K=F();var N=window.decodeURIComponent?decodeURIComponent:unescape;for(var I=0,H=K.length;I<H;++I){var M=K[I].indexOf("=");if(M===-1){continue}var L=K[I].substring(0,M);var J=K[I].substring(M+1);J=J.replace(/\+/g," ");D[L]=N(J)}return D},makeClosure:function(K,M,L){var J=[];for(var I=2,H=arguments.length;I<H;++I){J.push(arguments[I])}return function(){var N=J.slice();for(var P=0,O=arguments.length;P<O;++P){N.push(arguments[P])}return M.apply(K,N)}},makeEnum:function(I){var K={};for(var J=0,H;H=I[J];++J){K[H]=H}return K},getFeatureParameters:function(H){return typeof C[H]==="undefined"?null:C[H]},hasFeature:function(H){return typeof C[H]!=="undefined"},registerOnLoadHandler:function(H){E.push(H)},runOnLoadHandlers:function(){for(var I=0,H=E.length;I<H;++I){E[I]()}},escape:function(H,L){if(!H){return H}else{if(typeof H==="string"){return gadgets.util.escapeString(H)}else{if(typeof H==="array"){for(var K=0,I=H.length;K<I;++K){H[K]=gadgets.util.escape(H[K])}}else{if(typeof H==="object"&&L){var J={};for(var M in H){if(H.hasOwnProperty(M)){J[gadgets.util.escapeString(M)]=gadgets.util.escape(H[M],true)}}return J}}}}return H},escapeString:function(L){var I=[],K,M;for(var J=0,H=L.length;J<H;++J){K=L.charCodeAt(J);M=A[K];if(M===true){I.push("&#",K,";")}else{if(M!==false){I.push(L.charAt(J))}}}return I.join("")},unescapeString:function(H){return H.replace(/&#([0-9]+);/g,B)}}}();gadgets.util.getUrlParameters();var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();var gadgets=gadgets||{};gadgets.rpc=function(){var K={};var N=[];var I={};var C={};var L={};var H=0;var J={};var D=gadgets.util.getUrlParameters();L[".."]=D.rpctoken||D.ifpctok||0;var E=typeof document.postMessage==="function"?"dpm":typeof window.postMessage==="function"?"wpm":"ifpc";if(E==="dpm"||E==="wpm"){document.addEventListener("message",function(O){B(gadgets.json.parse(O.data))},false)}K[""]=function(){throw new Error("Unknown RPC service: "+this.s)};K.__cb=function(P,O){var Q=J[P];if(Q){delete J[P];Q(O)}};function G(Q){var S=gadgets.json.stringify;var O=[];for(var R=0,P=Q.length;R<P;++R){O.push(encodeURIComponent(S(Q[R])))}return O.join("&")}function B(S){if(S&&typeof S.s==="string"&&typeof S.f==="string"&&S.a instanceof Array){if(L[S.f]){if(L[S.f]!=S.t){throw new Error("Invalid auth token.")}}if(E==="ifpc"){if(S.f===".."){try{var P=window.frameElement;if(typeof P.__g2c_rpc==="function"&&typeof P.__g2c_rpc.__c2g_rpc!="function"){P.__g2c_rpc.__c2g_rpc=function(T){B(gadgets.json.parse(T))}}}catch(R){}}else{var Q=document.getElementById(S.f);if(Q&&typeof Q.__g2c_rpc!="function"){Q.__g2c_rpc=function(T){B(gadgets.json.parse(T))}}}}var O=(K[S.s]||K[""]).apply(S,S.a);if(S.c){gadgets.rpc.call(S.f,"__cb",null,S.c,O)}}}function F(R){var P;for(var O=N.length-1;O>=0;--O){var S=N[O];try{if(S&&(S.recyclable||S.readyState==="complete")){S.parentNode.removeChild(S);if(window.ActiveXObject){N[O]=S=null;N.splice(O,1)}else{S.recyclable=false;P=S;break}}}catch(Q){}}if(!P){P=document.createElement("iframe");P.style.border=P.style.width=P.style.height="0px";P.style.visibility="hidden";P.style.position="absolute";P.onload=function(){this.recyclable=true};N.push(P)}P.src=R;setTimeout(function(){document.body.appendChild(P)},0)}if(gadgets.config){function M(O){if(O.rpc.parentRelayUrl.substring(0,7)==="http://"){I[".."]=O.rpc.parentRelayUrl}else{var S=document.location.search.substring(0).split("&");var R="";for(var P=0,Q;Q=S[P];++P){if(Q.indexOf("parent=")===0){R=decodeURIComponent(Q.substring(7));break}}I[".."]=R+O.rpc.parentRelayUrl}C[".."]=!!O.rpc.useLegacyProtocol}var A={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",A,M)}return{register:function(P,O){K[P]=O},unregister:function(O){delete K[O]},registerDefault:function(O){K[""]=O},unregisterDefault:function(){delete K[""]},call:function(X,T,Y,W){++H;X=X||"..";if(Y){J[H]=Y}var V;if(X===".."){V=window.name}else{V=".."}var Q=gadgets.json.stringify({s:T,f:V,c:Y?H:0,a:Array.prototype.slice.call(arguments,3),t:L[X]});switch(E){case"dpm":var Z=X===".."?parent.document:frames[X].document;Z.postMessage(Q);break;case"wpm":var U=X===".."?parent:frames[X];U.postMessage(Q);break;default:try{if(V===".."){var R=document.getElementById(X);if(typeof R.__g2c_rpc.__c2g_rpc==="function"){R.__g2c_rpc.__c2g_rpc(Q);return }}else{if(typeof window.frameElement.__g2c_rpc==="function"){window.frameElement.__g2c_rpc(Q);return }}}catch(S){}var P=gadgets.rpc.getRelayUrl(X);var O;if(C[X]){O=[P,"#",G([V,H,1,0,G([V,T,"","",V].concat(Array.prototype.slice.call(arguments,3)))])].join("")}else{O=[P,"#",X,"&",V,"@",H,"&1&0&",encodeURIComponent(Q)].join("")}F(O)}},getRelayUrl:function(O){return I[O]},setRelayUrl:function(P,O,Q){I[P]=O;C[P]=!!Q},setAuthToken:function(O,P){L[O]=P},getRelayChannel:function(){return E},receive:function(O){if(O.length>4){B(gadgets.json.parse(decodeURIComponent(O[O.length-1])))}}}}();